<!DOCTYPE html>
<html>
<head>
  <style>
    #vis.vega-embed {
      width: 100%;
      display: flex;
    }

    #vis.vega-embed details,
    #vis.vega-embed details summary {
      position: relative;
    }
  </style>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/vega@5"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/vega-lite@5.20.1"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
</head>
<body>
  <div id="vis"></div>
  <script>
    (function(vegaEmbed) {
      var spec = {"config": {"title": {"font": "system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', 'Liberation Sans', sans-serif"}, "axis": {"labelFont": "system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', 'Liberation Sans', sans-serif", "titleFont": "system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', 'Liberation Sans', sans-serif", "labelFontSize": 14, "titleFontSize": 13}, "header": {"labelFont": "system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', 'Liberation Sans', sans-serif", "titleFont": "system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', 'Liberation Sans', sans-serif", "labelFontSize": 14, "titleFontSize": 13}, "legend": {"labelFont": "system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', 'Liberation Sans', sans-serif", "titleFont": "system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', 'Liberation Sans', sans-serif", "titleFontSize": 14, "labelFontSize": 14}, "text": {"font": "system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', 'Liberation Sans', sans-serif", "fontSize": 16}}, "hconcat": [{"vconcat": [{"data": {"name": "data-8b9b7bbc32184f6aaa2eb3c58dc13fef"}, "mark": {"type": "text", "align": "left", "baseline": "top", "dx": -95, "fontSize": 12, "lineBreak": "\n", "size": 10}, "encoding": {"text": {"field": "text", "type": "nominal"}}, "height": 50, "width": 100}, {"vconcat": [{"layer": [{"layer": [{"data": {"name": "data-4eb1ebe2cf5f2ccc8f78afb17bec3c18"}, "mark": {"type": "rect", "color": "peachpuff", "opacity": 0.7}, "encoding": {"x": {"field": "x_min", "type": "quantitative"}, "x2": {"field": "x_max"}}}, {"data": {"name": "data-41c1925c97be1aa058ca05dd4d9f76ae"}, "mark": {"type": "line", "point": true}, "encoding": {"color": {"field": "sample", "legend": null, "scale": {"scheme": "category10"}, "type": "nominal"}, "x": {"field": "depth", "title": "Read Depth", "type": "quantitative"}, "y": {"field": "observed_features", "title": "# Observed Features", "type": "quantitative"}}, "name": "view_1", "title": "Rarefaction Curves"}, {"data": {"name": "data-110dcd2f824254d9035de85ae4e7c292"}, "mark": {"type": "rule", "strokeWidth": 2}, "encoding": {"color": {"field": "label", "legend": {"title": "Thresholds"}, "scale": {"range": ["#377eb8", "#f781bf", "#984ea3"]}, "type": "nominal"}, "x": {"field": "x", "type": "quantitative"}}}], "resolve": {"scale": {"color": "independent", "x": "shared"}}, "title": "Rarefaction Curves"}, {"data": {"name": "data-27d844e5c5b053990c0409f59f5f6cdd"}, "mark": {"type": "rule", "color": "black", "strokeWidth": 2}, "encoding": {"x": {"field": "position", "type": "quantitative"}}, "title": "Interactive Vertical Line", "transform": [{"calculate": "position", "as": "position"}, {"filter": {"param": "param_2"}}]}], "height": 350, "resolve": {"scale": {"x": "shared", "y": "shared"}}, "width": 450}, {"data": {"name": "data-e8c5cd781fcb9d5fa9d4582c6f27024c"}, "mark": {"type": "text", "align": "left", "baseline": "top", "dx": -95, "fontSize": 16, "lineBreak": "\n", "size": 14}, "encoding": {"text": {"field": "text", "type": "nominal"}}, "height": 50, "width": 100}], "spacing": 0}], "spacing": 0}, {"vconcat": [{"data": {"name": "data-8b9b7bbc32184f6aaa2eb3c58dc13fef"}, "mark": {"type": "text", "align": "left", "baseline": "top", "dx": -95, "dy": -5, "fontSize": 12, "lineBreak": "\n", "size": 10}, "encoding": {"text": {"field": "text", "type": "nominal"}}, "height": 50, "width": 100}, {"layer": [{"mark": {"type": "bar"}, "encoding": {"color": {"value": "lightgrey"}, "x": {"bin": {"maxbins": 50}, "field": "reads_per_sample", "title": "Reads per Sample", "type": "quantitative"}, "y": {"aggregate": "count", "title": "# Samples", "type": "quantitative"}}, "name": "view_2", "title": "Histogram of Reads per Sample"}, {"mark": {"type": "bar"}, "encoding": {"color": {"value": "steelblue"}, "x": {"bin": {"maxbins": 50}, "field": "reads_per_sample", "title": "Reads per Sample", "type": "quantitative"}, "y": {"aggregate": "count", "title": "# Samples", "type": "quantitative"}}, "title": "Histogram of Reads per Sample", "transform": [{"filter": "(datum.reads_per_sample >= position)"}, {"calculate": "position", "as": "position"}]}], "data": {"name": "data-bc4f991ed80914e522e3f50de36d8d89"}, "height": 350, "resolve": {"scale": {"x": "shared", "y": "shared"}}, "width": 450}], "spacing": 0}], "params": [{"name": "param_1", "select": {"type": "interval"}, "bind": "scales", "views": ["view_1", "view_2"]}, {"name": "param_2", "bind": {"input": "checkbox", "name": "Show read depth specified by slider as a line on the plot: "}}, {"name": "position", "bind": {"input": "range", "max": 6770, "min": 0, "name": "Rarefaction Depth Line", "step": 20}, "value": 2777}], "spacing": 60, "$schema": "https://vega.github.io/schema/vega-lite/v5.20.1.json", "datasets": {"data-8b9b7bbc32184f6aaa2eb3c58dc13fef": [{"text": "\n\n"}], "data-4eb1ebe2cf5f2ccc8f78afb17bec3c18": [{"x_min": 0, "x_max": 660}], "data-41c1925c97be1aa058ca05dd4d9f76ae": [{"depth": 1, "observed_features": 1.0, "sample": "L3S294"}, {"depth": 200, "observed_features": 36.0, "sample": "L3S294"}, {"depth": 400, "observed_features": 48.0, "sample": "L3S294"}, {"depth": 600, "observed_features": 50.0, "sample": "L3S294"}, {"depth": 800, "observed_features": 52.0, "sample": "L3S294"}, {"depth": 1, "observed_features": 1.0, "sample": "L1S57"}, {"depth": 1382, "observed_features": 78.0, "sample": "L1S57"}, {"depth": 2763, "observed_features": 84.0, "sample": "L1S57"}, {"depth": 4144, "observed_features": 87.0, "sample": "L1S57"}, {"depth": 5525, "observed_features": 88.0, "sample": "L1S57"}, {"depth": 1, "observed_features": 1.0, "sample": "L3S242"}, {"depth": 165, "observed_features": 16.0, "sample": "L3S242"}, {"depth": 330, "observed_features": 20.0, "sample": "L3S242"}, {"depth": 495, "observed_features": 26.0, "sample": "L3S242"}, {"depth": 660, "observed_features": 26.0, "sample": "L3S242"}, {"depth": 1, "observed_features": 1.0, "sample": "L3S378"}, {"depth": 213, "observed_features": 32.0, "sample": "L3S378"}, {"depth": 425, "observed_features": 38.0, "sample": "L3S378"}, {"depth": 637, "observed_features": 41.0, "sample": "L3S378"}, {"depth": 850, "observed_features": 42.0, "sample": "L3S378"}, {"depth": 1, "observed_features": 1.0, "sample": "L2S175"}, {"depth": 739, "observed_features": 97.0, "sample": "L2S175"}, {"depth": 1478, "observed_features": 122.0, "sample": "L2S175"}, {"depth": 2216, "observed_features": 129.0, "sample": "L2S175"}, {"depth": 2955, "observed_features": 132.0, "sample": "L2S175"}, {"depth": 1, "observed_features": 1.0, "sample": "L3S341"}, {"depth": 164, "observed_features": 52.0, "sample": "L3S341"}, {"depth": 327, "observed_features": 67.0, "sample": "L3S341"}, {"depth": 490, "observed_features": 74.0, "sample": "L3S341"}, {"depth": 653, "observed_features": 78.0, "sample": "L3S341"}, {"depth": 1, "observed_features": 1.0, "sample": "L4S137"}, {"depth": 1693, "observed_features": 143.0, "sample": "L4S137"}, {"depth": 3385, "observed_features": 160.0, "sample": "L4S137"}, {"depth": 5077, "observed_features": 169.0, "sample": "L4S137"}, {"depth": 6770, "observed_features": 170.0, "sample": "L4S137"}, {"depth": 1, "observed_features": 1.0, "sample": "L6S68"}, {"depth": 1146, "observed_features": 42.0, "sample": "L6S68"}, {"depth": 2292, "observed_features": 48.0, "sample": "L6S68"}, {"depth": 3437, "observed_features": 54.0, "sample": "L6S68"}, {"depth": 4583, "observed_features": 54.0, "sample": "L6S68"}, {"depth": 1, "observed_features": 1.0, "sample": "L2S357"}, {"depth": 384, "observed_features": 54.0, "sample": "L2S357"}, {"depth": 767, "observed_features": 67.0, "sample": "L2S357"}, {"depth": 1150, "observed_features": 74.0, "sample": "L2S357"}, {"depth": 1533, "observed_features": 75.0, "sample": "L2S357"}, {"depth": 1, "observed_features": 1.0, "sample": "L1S140"}, {"depth": 1188, "observed_features": 62.0, "sample": "L1S140"}, {"depth": 2375, "observed_features": 76.0, "sample": "L1S140"}, {"depth": 3562, "observed_features": 78.0, "sample": "L1S140"}, {"depth": 4749, "observed_features": 79.0, "sample": "L1S140"}], "data-110dcd2f824254d9035de85ae4e7c292": [{"x": 1533, "label": "-5%"}, {"x": 2777, "label": "Knee point"}, {"x": 2955, "label": "+5%"}], "data-27d844e5c5b053990c0409f59f5f6cdd": [{"position": 0}], "data-e8c5cd781fcb9d5fa9d4582c6f27024c": [{"text": "Knee point: 2777 (at the 50.00 percentile)\nKnee point -5%: 1533 (at the 45.00 percentile)\nKnee point +5%: 2955 (at the 55.00 percentile)\nThe shaded area is where at least 80.00% of the samples \nare kept, if used as the rarefaction depth.\n \nThe knee point is above the specified, acceptable depth range!\nThe upper bound of the acceptable range (keeping at least 80.00% of the samples) is 660.\n \nIf the calculated knee point is used, 50.00% of the samples will\n be excluded because they have too little reads."}], "data-bc4f991ed80914e522e3f50de36d8d89": [{"sample": 0, "reads_per_sample": 800}, {"sample": 1, "reads_per_sample": 5525}, {"sample": 2, "reads_per_sample": 660}, {"sample": 3, "reads_per_sample": 850}, {"sample": 4, "reads_per_sample": 2955}, {"sample": 5, "reads_per_sample": 653}, {"sample": 6, "reads_per_sample": 6770}, {"sample": 7, "reads_per_sample": 4583}, {"sample": 8, "reads_per_sample": 1533}, {"sample": 9, "reads_per_sample": 4749}]}};
      var embedOpt = {"actions": false, "mode": "vega-lite"};

      function showError(el, error){
          el.innerHTML = ('<div style="color:red;">'
                          + '<p>JavaScript Error: ' + error.message + '</p>'
                          + "<p>This usually means there's a typo in your chart specification. "
                          + "See the javascript console for the full traceback.</p>"
                          + '</div>');
          throw error;
      }
      const el = document.getElementById('vis');
      vegaEmbed("#vis", spec, embedOpt)
        .catch(error => showError(el, error));
    })(vegaEmbed);

  </script>
</body>
</html>