<!-- head copied from https://github.com/bokulich-lab/q2-fastp/blob/main/q2_fastp/assets/index.html
and https://github.com/bokulich-lab/q2-moshpit/blob/main/q2_moshpit/assets/busco/feature_data/index.html-->

{% extends 'base.html' %}

{% block head %}
<title>Embedding Vega-Lite</title>
<script src="./js/bootstrapMagic.js" type="text/javascript"></script>
<link href="./css/styles.css" rel="stylesheet"/>
<script type="text/javascript">
    // temporary hack to make it look good with Bootstrap 5
    removeBS3refs();
</script>
<script src="https://cdn.jsdelivr.net/npm//vega@5" type="text/javascript"></script>
<script src="https://cdn.jsdelivr.net/npm//vega-lite@5.16.3" type="text/javascript"></script>
<script src="https://cdn.jsdelivr.net/npm//vega-embed@6" type="text/javascript"></script>
<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>

<link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" integrity="sha256-YvdLHPgkqJ8DVUxjjnGVlMMJtNimJ6dYkowFFvp4kKs=" rel="stylesheet"/>
<!-- <style>
    input[type="range"] {
      font-family: system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', 'Liberation Sans', sans-serif !important;
      font-size: 12px;
      color: #333;
      background-color: #f5f5f5;
      border: 1px solid #ccc;
      border-radius: 4px;
      padding: 2px 5px;
    }
    .vega-bind-name {
        font-family: system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', 'Liberation Sans', sans-serif !important;
        font-size: 14px;
        font-weight: bold;
        color: #333;
        margin-right: 10px; /* Space between label and checkbox */
    }
    input[type="checkbox"] {
        width: 18px; /* Adjust size */
        height: 18px; /* Adjust size */
        accent-color: #007bff; /* Modern browsers support accent-color for the checkbox */
        cursor: pointer; /* Change cursor to pointer on hover */
    }
  </style> -->
  

{% endblock %}

{% block content %}

  <div class="row">
    <div class="col-lg-12">
        <div class="card">
            <h5 class="card-header">Automated Rarefaction Depth Summary</h5>
            <div class="card-body">
                <p>
                    The Rarefaction Curves plot on the left shows the number of observed features at each depth for
                    every sample as a curve. The shaded area represents the specified acceptable
                    range of rarefaction depths. The optimal rarefaction depth is depicted as the vertical line named knee point. 
                    It is the knee point that was calculated using the specified algorithm.
                    <!--fix/adjust this text!!-->
                </p>
                <p>
                    The Histogram of Reads per Sample on the right shows the number of samples which have a certain number of reads.
                    The grey bars are the samples that would be excluded if the rarefaction depth was set to the knee point, the blue bars the ones included.
                    (If the slider hasn't been moved, otherwise it shows the same but with respect to the slider.)
                </p>
                <p>
                    Zoom in and out of the plots for more or less details.
                </p>
                <p>
                    Click on the checkbox below the plots to show the line with the rarefaction depth according to the slider.
                    Move the slider to change the black rarefaction depth line accordingly. Additionally, the bars in the barplot 
                    on the right are blue if the sample has a read count above the specified rarefaction depth, meaning that
                    sample would be included if this rarefaction depth was chosen, otherwise the bars are grey. 
                </p>
                <p>
                    Below the plots the knee point and the knee point Â±5% is specified and at what percentiles those points lie.
                </p>
                <p>
                    ATTENTION! The default acceptable range of rarefaction depths is set to keeping at least 80% of all samples. 
                </p>
                <div class="col-lg-12" id="combinedChartContainer"> 
                     <iframe src="./new_chart.html" width="100%" height="700" scrolling="no" frameborder="0"></iframe>
                </div>
            </div>   
        </div> 
    </div>
  </div>

{% endblock %}

{% block footer %}
{% set loading_selector = '#loading' %}
{% include 'js-error-handler.html' %}

<!-- <script>
  // Apply styles for checkbox label and checkbox itself after the page loads
  document.addEventListener('DOMContentLoaded', function() {
    // Apply font styles directly to the checkbox label
    const label = document.querySelector('.vega-bind-name');
    if (label) {
      label.style.fontFamily = "system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', 'Liberation Sans', sans-serif !important";
      label.style.fontSize = "14px !important";
      label.style.fontWeight = "bold !important";
      label.style.color = "#333 !important";
    }

    // Apply styles to the checkbox itself
    const checkbox = document.querySelector('input[type="checkbox"]');
    if (checkbox) {
      checkbox.style.width = '18px !important';
      checkbox.style.height = '18px !important';
      checkbox.style.accentColor = '#007bff !important';
      checkbox.style.cursor = 'pointer !important';
      
      // Hover effect for the checkbox (using JavaScript as a fallback)
      checkbox.addEventListener('mouseover', function() {
        checkbox.style.boxShadow = '0 0 5px rgba(0, 123, 255, 0.5) !important';
      });
      checkbox.addEventListener('mouseout', function() {
        checkbox.style.boxShadow = 'none !important';
      });
    }
  });
</script> -->

{% endblock %}